#!kivy 1.5

<LightStrip>:
    button: button
    stencil: stencil
    lightbox: lightbox

    orientation: 'vertical'
    spacing: 5

    Button:
        id: button
        canvas:
            Clear
                Rectangle:
                    pos: self.pos
                    size: self.size
                Color:
                    rgb: root.color
                    a: 1
                Rectangle:
                    pos: self.width / 2, self.y
                    size: 10, 10
                    source:  'atlas://data/images/defaulttheme/tree_closed'
        size_hint: (None, None)
        y: self.parent.height - self.height
        size: self.width, 10

    StencilView:
        id: stencil
        size_hint: (None, 1)
        x: root.x
        width: 110
        LightBox:
            ls: self.parent.parent
            size_hint: (None, 1)
            id: lightbox
            color: root.color
            name: root.name
            size: root.parent.width, self.parent.parent.height
            y: self.parent.y
            x: self.parent.x
            args_pattern: "fff"
            path: self.ls.path # "/" + app.get_application_name().replace(" ", "_") + "/LightXYpad/" +  self.parent.name.replace(" ", "_") + "/" + str(self.mode)
            control_path: root.control_path if root.control_path else self.path

<Qlc>:
    lightsm: lightsm
    front_s: front_s
    main_s: main_s
    stf: stf

    barres: barres

    orl64: orl64
#    orl64_st: orl64_st


    ScreenManager:
        id: lightsm
        size_hint: 1, 1

        Screen:
            id: main_s
            name: 'main'
            size_hint: 1, 1
            GridLayout:
                size_hint: 1, 1
                rows: 2
                cols: 2
                spacing: 5

                LightStrip:
                    id: barres
                    size_hint: 1, 1
                    path: '/dummy'
                    color: 1, 0, 0
                    name: 'Barres'
                    on_touch_down:
                        if self.button.collide_point(args[1].x, args[1].y): root.zoom_strip(self.lightbox)

                LightStrip:
                    id: orl64
                    size_hint: 1, 1
                    path: '/dummy'
                    color: 1, 1, 0
                    name: 'PARs 64 ORL'
                    on_touch_down:
                        if self.button.collide_point(args[1].x, args[1].y): root.zoom_strip(self.lightbox)

       

                BoxLayout:
                    orientation: 'vertical'
                    size_hint: 1, 1
                    spacing: 5
                    Button:
                        canvas:
                            Clear
                            Rectangle:
                                pos: self.pos
                                size: self.size
                            Color:
                                rgba: 1, 1, 1, 1
                            Rectangle:
                                pos: self.width / 2, self.y
                                size: 10, 10
                                source:  'atlas://data/images/defaulttheme/tree_closed'
                        size_hint: (None, None)
                        y: self.parent.height - self.height
                        size: self.width, 10
                        on_press: 
                            root.zoom_strip(orl64)
                    StencilView:
#                        id: orl64_st
                        size_hint: (None, 1)
                        width: 110
                        LightBox:
                            size_hint: (None, 1)
#                            id: orl64
                            color: 0, 1, 1
                            name: 'PAR 64 ORL'
                            size: root.width, self.parent.height
                            x: self.parent.x
                            args_pattern: "fff"
                            path: "/" + app.get_application_name().replace(" ", "_") + "/LightXYpad/" +  self.name.replace(" ", "_") + "/" + str(self.mode)
                            control_path: self.path

                BoxLayout:
                    orientation: 'vertical'
                    size_hint: 1, 1
                    spacing: 5
                    Button:
                        canvas:
                            Clear
                            Rectangle:
                                pos: self.pos
                                size: self.size
                            Color:
                                rgba: 1, 1, 1, 1
                            Rectangle:
                                pos: self.width / 2, self.y
                                size: 10, 10
                                source:  'atlas://data/images/defaulttheme/tree_closed'
                        size_hint: (None, None)
                        y: self.parent.height - self.height
                        size: self.width, 10
                        on_press: 
                            root.zoom_strip(orl64)
                    StencilView:
#                        id: orl64_st
                        size_hint: (None, 1)
                        width: 110
                        LightBox:
                            size_hint: (None, 1)
#                            id: orl64
                            color: 0, 1, 1
                            name: 'PAR 64 ORL'
                            size: root.width, self.parent.height
                            x: self.parent.x
                            args_pattern: "fff"
                            path: "/" + app.get_application_name().replace(" ", "_") + "/LightXYpad/" +  self.name.replace(" ", "_") + "/" + str(self.mode)
                            control_path: self.path

           


        Screen:
            id: front_s
            size_hint: 1, 1
            name: 'front'
            Button:
                color: 0, 1, 1
                size_hint: (None, None)
                pos: 0, root.height - self.height
                size: 30, 30
                text: 'E'
                on_press: 
                    root.restore_zoomed_strip()

            StencilView:
                id: stf
                x: root.x
                y: root.y
                size_hint: (None, None)
                height: root.height - 30 # - root.vb.height - 10
                width: root.width        
